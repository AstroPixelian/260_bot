# Windows 打包部署指南

## 🎯 打包步骤

### 1. 环境准备 (在 Windows 环境中)

确保你的 Windows 开发环境已安装：
- Python 3.12+
- 项目依赖 (uv 或 pip 安装)

### 2. 安装 Nuitka

```bash
# 使用 uv (推荐)
uv add --dev nuitka

# 或使用 pip
pip install nuitka
```

### 3. 运行打包脚本

```bash
python build_exe.py
```

### 4. 打包输出

打包完成后会在 `dist/` 目录生成：

```
dist/
├── 360-账号批量注册工具.exe    # 主程序 (约 50-80MB)
├── 安装浏览器.bat              # 浏览器安装脚本
└── 使用说明.txt               # 用户指南
```

## 📦 分发包结构

向用户提供的完整包应包含：

1. **主程序**: `360-账号批量注册工具.exe`
2. **安装脚本**: `安装浏览器.bat` 
3. **说明文档**: `使用说明.txt`

## 🔧 技术细节

### Nuitka 关键配置

```python
# 重要的 Nuitka 选项
--standalone              # 独立可执行文件
--onefile                # 单文件打包
--include-package=playwright    # 包含 Playwright
--include-package-data=playwright  # 包含 Playwright 数据文件
--windows-console-mode=attach     # Windows 控制台模式
--lto=no                 # 禁用链接优化(避免 Playwright 问题)
```

### Playwright 处理策略

1. **程序内置检查**: 程序启动时自动检查浏览器是否已安装
2. **用户交互安装**: 如果未安装，提示用户是否安装
3. **自动下载安装**: 调用 `playwright install chromium` 命令
4. **备用方案**: 提供独立的 .bat 脚本供用户手动安装

### 文件大小优化

- 打包后的 exe 文件预计 50-80MB
- Playwright 浏览器文件另外约 100-200MB (首次运行时下载)
- 总计约 150-280MB 的磁盘空间需求

## ⚠️ 已知限制和解决方案

### 1. 防病毒软件误报

**问题**: Nuitka 打包的 exe 可能被某些杀毒软件误报
**解决方案**:
- 添加到杀毒软件白名单
- 使用代码签名证书 (商业发布)
- 在程序中添加更多元数据

### 2. 首次运行较慢

**问题**: 第一次运行时需要下载 Playwright 浏览器
**解决方案**:
- 提供预安装脚本
- 在用户文档中明确说明
- 显示下载进度

### 3. Windows Defender SmartScreen

**问题**: Windows 可能显示"未识别的应用"警告
**解决方案**:
- 用户需要点击"更多信息" -> "仍要运行"
- 考虑申请代码签名证书

## 🚀 发布清单

### 开发者发布前检查

- [ ] 在 Windows 环境中完整测试
- [ ] 验证 Playwright 自动安装功能  
- [ ] 测试完整的账号注册流程
- [ ] 检查输出的 CSV 文件格式
- [ ] 验证实时日志显示功能
- [ ] 测试错误处理和用户提示

### 用户文档检查

- [ ] 首次使用步骤清晰
- [ ] 故障排除指南完整
- [ ] 系统要求明确
- [ ] 联系方式或支持信息

### 文件完整性检查

- [ ] exe 文件可执行
- [ ] 安装脚本正确编码 (UTF-8)
- [ ] 说明文档可读
- [ ] 无多余的调试文件

## 🎯 用户反馈处理

### 常见问题预案

1. **"程序无法启动"**
   - 检查是否运行了浏览器安装脚本
   - 确认 Windows 版本兼容性

2. **"浏览器下载失败"**  
   - 检查网络连接
   - 尝试使用代理或 VPN
   - 手动运行 `playwright install chromium`

3. **"注册过程出错"**
   - 启用详细日志查看具体错误
   - 检查网络稳定性
   - 减少批量注册数量

## 📊 性能指标

### 预期性能

- **启动时间**: 5-15 秒 (首次运行含浏览器检查)
- **内存使用**: 200-500MB (含浏览器进程)
- **单账号注册时间**: 30-60 秒 (网络状况决定)
- **批量处理能力**: 建议每批不超过 50 个账号

### 资源需求

- **最小内存**: 4GB RAM
- **推荐内存**: 8GB RAM
- **磁盘空间**: 300MB (含浏览器)
- **网络**: 稳定的互联网连接

---

## 📝 版本信息

- **构建工具**: Nuitka 2.7.13+
- **Python 版本**: 3.12+
- **Playwright 版本**: 1.44.0+
- **Rich 版本**: 14.1.0+

构建日期: 2025-01-XX
版本: 1.0.0